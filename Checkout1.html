<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fresh Menu - Checkout</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background-color: #f9fafb;
            color: #1f2937;
        }

        .header {
            background-color: white;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 50;
        }

        .header-content {
            max-width: 1280px;
            margin: 0 auto;
            padding: 1rem 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            flex-direction: column;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .logo:hover {
            transform: scale(1.05);
        }

        .logo-top {
            font-size: 14px;
            font-weight: 500;
            color: #2c3e50;
            letter-spacing: 1px;
            animation: slideDown 0.6s ease;
        }

        .logo-main {
            font-size: 36px;
            font-weight: 900;
            color: rgb(31, 70, 31);
            letter-spacing: -1px;
            line-height: 1;
            animation: bounceIn 0.8s ease;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes bounceIn {
            0% {
                opacity: 0;
                transform: scale(0.3);
            }
            50% {
                transform: scale(1.05);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        .container {
            max-width: 1280px;
            margin: 0 auto;
            padding: 2rem 1.5rem;
        }

        .back-btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #6b7280;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            margin-bottom: 1.5rem;
        }

        .back-btn:hover {
            color: #1f2937;
        }

        h1 {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 2rem;
        }

        .checkout-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 2rem;
        }

        .form-section {
            background: white;
            border-radius: 0.5rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 1.5rem;
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        label {
            display: block;
            font-weight: 500;
            margin-bottom: 0.5rem;
            color: #374151;
        }

        .required {
            color: #ef4444;
        }

        input, textarea {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            font-size: 1rem;
            transition: all 0.3s;
        }

        input:focus, textarea:focus {
            outline: none;
            border-color: #fbbf24;
            box-shadow: 0 0 0 3px rgba(251, 191, 36, 0.1);
        }

        input.error, textarea.error {
            border-color: #ef4444;
        }

        .error-message {
            color: #ef4444;
            font-size: 0.875rem;
            margin-top: 0.25rem;
        }

        textarea {
            resize: vertical;
            min-height: 80px;
        }

        .order-summary {
            background: white;
            border-radius: 0.5rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
            position: sticky;
            top: 6rem;
            height: fit-content;
        }

        .summary-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.75rem;
            color: #4b5563;
        }

        .summary-divider {
            border-top: 1px solid #e5e7eb;
            margin: 1rem 0;
        }

        .total-row {
            display: flex;
            justify-content: space-between;
            font-size: 1.25rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .tax-details {
            font-size: 0.875rem;
            color: #6b7280;
            margin-top: 0.5rem;
        }

        .warning-box {
            background-color: #fef3c7;
            border: 1px solid #fcd34d;
            border-radius: 0.5rem;
            padding: 1rem;
            margin: 1.5rem 0;
            font-size: 0.875rem;
            color: #92400e;
        }

        .payment-btn {
            width: 100%;
            background-color: #fbbf24;
            color: #1f2937;
            padding: 1rem;
            border-radius: 0.5rem;
            font-weight: bold;
            font-size: 1.125rem;
            border: none;
            cursor: pointer;
            transition: background-color 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .payment-btn:hover:not(:disabled) {
            background-color: #f59e0b;
        }

        .payment-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .features {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            margin-top: 1rem;
            font-size: 0.875rem;
            color: #6b7280;
        }

        .feature-item {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .spinner {
            border: 2px solid #1f2937;
            border-top: 2px solid transparent;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @media (max-width: 1024px) {
            .checkout-grid {
                grid-template-columns: 1fr;
            }

            .order-summary {
                position: static;
            }
        }

        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }

            h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <span class="logo-top">FOOD</span>
                <span class="logo-main">EXPRESS</span>
            </div>
        </div>
    </header>

    <div class="container">
        <button class="back-btn" onclick="window.history.back()">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M19 12H5M12 19l-7-7 7-7"/>
            </svg>
            Back to Cart
        </button>

        <h1>CHECKOUT</h1>

        <div class="checkout-grid">
            <div>
                <div class="form-section">
                    <h2 class="section-title">CONTACT INFORMATION</h2>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Full Name <span class="required">*</span></label>
                            <input type="text" id="fullName" placeholder="Enter your full name">
                            <div class="error-message" id="fullNameError"></div>
                        </div>
                        <div class="form-group">
                            <label>Email <span class="required">*</span></label>
                            <input type="email" id="email" placeholder="Enter your email">
                            <div class="error-message" id="emailError"></div>
                        </div>
                        <div class="form-group full-width">
                            <label>Phone Number <span class="required">*</span></label>
                            <input type="tel" id="phoneNumber" placeholder="Enter your phone number">
                            <div class="error-message" id="phoneNumberError"></div>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h2 class="section-title">DELIVERY ADDRESS</h2>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Door/Flat Number <span class="required">*</span></label>
                            <input type="text" id="doorFlat" placeholder="e.g., Flat 102, ABC Apartment">
                            <div class="error-message" id="doorFlatError"></div>
                        </div>
                        <div class="form-group">
                            <label>Mobile Number <span class="required">*</span></label>
                            <input type="tel" id="mobileNumber" placeholder="Enter your mobile number">
                            <div class="error-message" id="mobileNumberError"></div>
                        </div>
                        <div class="form-group full-width">
                            <label>Email Address <span class="required">*</span></label>
                            <input type="email" id="emailAddress" placeholder="Enter your email address">
                            <div class="error-message" id="emailAddressError"></div>
                        </div>
                        <div class="form-group full-width">
                            <label>Full Address <span class="required">*</span></label>
                            <textarea id="fullAddress" placeholder="Enter your full address"></textarea>
                            <div class="error-message" id="fullAddressError"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div>
                <div class="order-summary">
                    <h3>Order Summary</h3>

                    <div class="summary-row">
                        <span>Subtotal</span>
                        <span id="summarySubtotal">₹0</span>
                    </div>

                    <div class="summary-row">
                        <span>Product Discount (15%)</span>
                        <span id="summaryProdDiscount">- ₹0</span>
                    </div>

                    <div class="summary-row">
                        <span>Coupon Discount</span>
                        <span id="summaryCoupon">- ₹0</span>
                    </div>

                    <div class="summary-row">
                        <span>GST (5%)</span>
                        <span id="summaryTaxes">₹0</span>
                    </div>

                    <div class="summary-row">
                        <span>Packaging Charge</span>
                        <span id="summaryPackaging">₹0</span>
                    </div>

                    <div class="summary-row">
                        <span>Shipping Charge</span>
                        <span id="summaryShipping">₹0</span>
                    </div>

                    <div class="summary-divider"></div>

                    <div class="total-row">
                        <span>Total Payable</span>
                        <span id="summaryTotal">₹0</span>
                    </div>

                    <div class="tax-details">
                        <div>CGST (2.5%): <span id="cgstValue">₹0</span></div>
                        <div>SGST (2.5%): <span id="sgstValue">₹0</span></div>
                    </div>

                    <div class="warning-box">
                        Please enter or select a valid delivery address to proceed with payment options.
                    </div>

                    <button class="payment-btn" id="paymentBtn">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect>
                            <line x1="1" y1="10" x2="23" y2="10"></line>
                        </svg>
                        Proceed to Payment
                    </button>

                    <div class="features">
                        <div class="feature-item">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                <circle cx="12" cy="12" r="3"></circle>
                            </svg>
                            Free Delivery
                        </div>
                        <div class="feature-item">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>
                            </svg>
                            Secure Packaging
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ===== CART DATA INITIALIZATION =====
        const PACKAGING_CHARGE = 20;
        const SHIPPING_CHARGE = 40;
        let appliedCoupon = "";
        let cart = [];

        // Load cart data from sessionStorage or localStorage
        function loadCartData() {
            try {
                const cartData = sessionStorage.getItem('cartData') || localStorage.getItem('cartData');
                const couponData = sessionStorage.getItem('appliedCoupon') || localStorage.getItem('appliedCoupon');
                
                if (cartData) {
                    cart = JSON.parse(cartData);
                }
                if (couponData) {
                    appliedCoupon = couponData;
                }
                
                console.log('Cart loaded:', cart);
                console.log('Coupon loaded:', appliedCoupon);
            } catch (e) {
                console.error('Error loading cart data:', e);
                cart = [];
            }
        }

        // ===== UTILITY FUNCTIONS =====
        function formatPrice(val) {
            return "₹" + val.toFixed(2);
        }

        // ===== UPDATE SUMMARY =====
        function updateSummary() {
            if (!cart || cart.length === 0) {
                document.getElementById("summarySubtotal").textContent = "₹0.00";
                document.getElementById("summaryProdDiscount").textContent = "- ₹0.00";
                document.getElementById("summaryCoupon").textContent = "- ₹0.00";
                document.getElementById("summaryTaxes").textContent = "₹0.00";
                document.getElementById("summaryPackaging").textContent = "₹0.00";
                document.getElementById("summaryShipping").textContent = "₹0.00";
                document.getElementById("summaryTotal").textContent = "₹0.00";
                document.getElementById("cgstValue").textContent = "₹0.00";
                document.getElementById("sgstValue").textContent = "₹0.00";
                return;
            }

            const subtotal = cart.reduce((sum, item) => sum + item.price * item.qty, 0);
            const productDiscount = subtotal * 0.15;

            let couponDiscount = 0;
            if (appliedCoupon === "SAVE10") couponDiscount = subtotal * 0.10;
            if (appliedCoupon === "SAVE50") couponDiscount = 50;
            if (appliedCoupon === "SAVE100") couponDiscount = 100;

            const afterDiscounts = Math.max(subtotal - productDiscount - couponDiscount, 0);
            const gst = afterDiscounts * 0.05;
            const cgst = gst / 2;
            const sgst = gst / 2;

            const packaging = PACKAGING_CHARGE;
            const shipping = SHIPPING_CHARGE;

            const total = afterDiscounts + gst + packaging + shipping;

            document.getElementById("summarySubtotal").textContent = formatPrice(subtotal);
            document.getElementById("summaryProdDiscount").textContent = "- " + formatPrice(productDiscount);
            document.getElementById("summaryCoupon").textContent = "- " + formatPrice(couponDiscount);
            document.getElementById("summaryTaxes").textContent = formatPrice(gst);
            document.getElementById("summaryPackaging").textContent = formatPrice(packaging);
            document.getElementById("summaryShipping").textContent = formatPrice(shipping);
            document.getElementById("summaryTotal").textContent = formatPrice(total);

            document.getElementById("cgstValue").textContent = formatPrice(cgst);
            document.getElementById("sgstValue").textContent = formatPrice(sgst);
        }

        // ===== FORM VALIDATION =====
        const formFields = {
            fullName: document.getElementById('fullName'),
            email: document.getElementById('email'),
            phoneNumber: document.getElementById('phoneNumber'),
            doorFlat: document.getElementById('doorFlat'),
            mobileNumber: document.getElementById('mobileNumber'),
            emailAddress: document.getElementById('emailAddress'),
            fullAddress: document.getElementById('fullAddress')
        };

        const errorFields = {
            fullName: document.getElementById('fullNameError'),
            email: document.getElementById('emailError'),
            phoneNumber: document.getElementById('phoneNumberError'),
            doorFlat: document.getElementById('doorFlatError'),
            mobileNumber: document.getElementById('mobileNumberError'),
            emailAddress: document.getElementById('emailAddressError'),
            fullAddress: document.getElementById('fullAddressError')
        };

        Object.keys(formFields).forEach(key => {
            formFields[key].addEventListener('input', function() {
                this.classList.remove('error');
                errorFields[key].textContent = '';
            });
        });

        function isValidEmail(email) {
            return /\S+@\S+\.\S+/.test(email);
        }

        function isValidPhone(phone) {
            return /^\d{10}$/.test(phone.replace(/\s/g, ''));
        }

        function validateForm() {
            let isValid = true;

            Object.keys(errorFields).forEach(key => {
                errorFields[key].textContent = '';
                formFields[key].classList.remove('error');
            });

            if (!formFields.fullName.value.trim()) {
                errorFields.fullName.textContent = 'Full name is required';
                formFields.fullName.classList.add('error');
                isValid = false;
            }

            if (!formFields.email.value.trim()) {
                errorFields.email.textContent = 'Email is required';
                formFields.email.classList.add('error');
                isValid = false;
            } else if (!isValidEmail(formFields.email.value)) {
                errorFields.email.textContent = 'Please enter a valid email';
                formFields.email.classList.add('error');
                isValid = false;
            }

            if (!formFields.phoneNumber.value.trim()) {
                errorFields.phoneNumber.textContent = 'Phone number is required';
                formFields.phoneNumber.classList.add('error');
                isValid = false;
            } else if (!isValidPhone(formFields.phoneNumber.value)) {
                errorFields.phoneNumber.textContent = 'Please enter a valid 10-digit phone number';
                formFields.phoneNumber.classList.add('error');
                isValid = false;
            }

            if (!formFields.doorFlat.value.trim()) {
                errorFields.doorFlat.textContent = 'Door/Flat number is required';
                formFields.doorFlat.classList.add('error');
                isValid = false;
            }

            if (!formFields.mobileNumber.value.trim()) {
                errorFields.mobileNumber.textContent = 'Mobile number is required';
                formFields.mobileNumber.classList.add('error');
                isValid = false;
            } else if (!isValidPhone(formFields.mobileNumber.value)) {
                errorFields.mobileNumber.textContent = 'Please enter a valid 10-digit mobile number';
                formFields.mobileNumber.classList.add('error');
                isValid = false;
            }

            if (!formFields.emailAddress.value.trim()) {
                errorFields.emailAddress.textContent = 'Email address is required';
                formFields.emailAddress.classList.add('error');
                isValid = false;
            } else if (!isValidEmail(formFields.emailAddress.value)) {
                errorFields.emailAddress.textContent = 'Please enter a valid email';
                formFields.emailAddress.classList.add('error');
                isValid = false;
            }

            if (!formFields.fullAddress.value.trim()) {
                errorFields.fullAddress.textContent = 'Full address is required';
                formFields.fullAddress.classList.add('error');
                isValid = false;
            }

            return isValid;
        }

        // ===== PAYMENT BUTTON HANDLER =====
        const paymentBtn = document.getElementById('paymentBtn');
        paymentBtn.addEventListener('click', function() {
            if (validateForm()) {
                this.disabled = true;
                this.innerHTML = `
                    <div class="spinner"></div>
                    Processing...
                `;

                setTimeout(() => {
                    alert('Order confirmed! Proceeding to payment gateway...');
                    this.disabled = false;
                    this.innerHTML = `
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect>
                            <line x1="1" y1="10" x2="23" y2="10"></line>
                        </svg>
                        Proceed to Payment
                    `;
                }, 1500);
            } else {
                const firstError = document.querySelector('.error');
                if (firstError) {
                    firstError.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            }
        });

        // ===== INITIALIZATION =====
        loadCartData();
        updateSummary();
    </script>
</body>
</html>